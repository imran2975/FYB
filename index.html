<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FYB of the Week Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Library for capturing HTML as an image -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0fdf4;
        }

        .card-bg {
            background: #ffffff;
            background: linear-gradient(135deg, #dcfce7 0%, #ffffff 50%, #dcfce7 100%);
            position: relative;
        }

        /* Fixed dimensions for the capture area to prevent distortion */
        #capture {
            width: 400px;
            height: 500px;
            overflow: hidden;
            background-color: white;
        }

        .profile-circle {
            border: 3px solid #16a34a;
            width: 130px;
            height: 130px;
            border-radius: 9999px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .label-pill {
            background: #16a34a;
            color: white;
            border-radius: 9999px;
            padding: 2px 10px;
            font-weight: 700;
            font-size: 10px;
            display: inline-block;
            line-height: 1;
        }

        .gradient-bar {
            height: 4px; /* Slightly thinner to accommodate more rows */
            border-radius: 9999px;
            margin-top: 1px;
        }

        .bar-green { background: #15803d; }
        .bar-red { background: #b91c1c; }

        .output-text {
            font-weight: 800;
            color: #1a202c;
        }

        .quote-box {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid #bbf7d0;
            padding: 6px;
            border-radius: 8px;
            font-size: 10px;
            font-style: italic;
            font-weight: 700;
            line-height: 1.2;
        }

        @media print {
            .no-print { display: none; }
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex flex-col items-center justify-center">

    <div class="w-full max-w-5xl grid grid-cols-1 lg:grid-cols-2 gap-8">
        
        <!-- Input Form -->
        <div class="no-print bg-white p-6 rounded-2xl shadow-xl border border-green-100 h-fit max-h-[90vh] overflow-y-auto">
            <h2 class="text-xl font-bold text-green-800 mb-6 flex items-center gap-2">
                <i data-lucide="settings"></i> Customize Profile
            </h2>
            
            <div class="space-y-4">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="sm:col-span-2">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Profile Photo</label>
                        <input type="file" id="imageInput" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100">
                    </div>
                    <input type="text" id="in-name" placeholder="Full Name" class="p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none">
                    <input type="text" id="in-dob" placeholder="Date of Birth" class="p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none">
                    <input type="text" id="in-origin" placeholder="State of Origin" class="p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none">
                    <input type="text" id="in-quote" placeholder="Inspirational Quote" class="p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none">
                    <input type="text" id="in-instagram" placeholder="Instagram Handle" class="p-2 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none">
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 border-t border-green-50">
                    <input type="text" id="in-lecturer" placeholder="Best Lecturer" class="p-2 border rounded-lg">
                    <input type="text" id="in-bestlevel" placeholder="Best Level" class="p-2 border rounded-lg">
                    <input type="text" id="in-worstlevel" placeholder="Worst Level" class="p-2 border rounded-lg">
                    <input type="text" id="in-bestcourse" placeholder="Best Course" class="p-2 border rounded-lg">
                    <input type="text" id="in-worstcourse" placeholder="Worst Course" class="p-2 border rounded-lg">
                    <input type="text" id="in-ifnot" placeholder="If Not Biochemistry" class="p-2 border rounded-lg">
                    <input type="text" id="in-crush" placeholder="Crush in Class" class="p-2 border rounded-lg">
                    <input type="text" id="in-status" placeholder="Relationship Status" class="p-2 border rounded-lg">
                    <input type="text" id="in-hobbies" placeholder="Hobbies" class="p-2 border rounded-lg">
                </div>

                <button onclick="exportAsImage(event)" class="w-full bg-green-600 hover:bg-green-700 text-white font-black py-4 rounded-xl transition-all shadow-lg flex items-center justify-center gap-3 mt-4 text-lg">
                    <i data-lucide="camera" class="w-6 h-6"></i> EXPORT HIGH-RES PNG
                </button>
            </div>
        </div>

        <!-- Preview Card -->
        <div id="capture" class="card-bg relative flex flex-col p-4 border-[8px] border-white shadow-2xl">
            
            <!-- Header -->
            <div class="text-center mb-2">
                <h1 class="text-[14px] font-extrabold text-green-900 leading-tight">NORTHWEST UNIVERSITY KANO</h1>
                <p class="text-[10px] font-semibold text-gray-700 uppercase">Faculty of Basic Medical Sciences</p>
                <p class="text-[8px] font-bold text-gray-500 uppercase tracking-widest">Department of Biochemistry</p>
            </div>

            <!-- FYB Title Row -->
            <div class="flex justify-between items-center px-2 mb-2">
                <div class="flex flex-col">
                    <span class="text-3xl font-black italic text-green-700 leading-none">FYB</span>
                    <span class="text-[7px] font-bold text-red-600 tracking-[0.2em]">OF THE WEEK</span>
                </div>
                <div class="text-right">
                    <h2 class="text-[14px] font-black text-green-900 leading-none">THE METABOLITES</h2>
                    <span class="bg-red-500 text-white text-[7px] font-bold px-2 py-0.5 rounded-full inline-block mt-1">FYB OF THE WEEK</span>
                </div>
            </div>

            <!-- Main Layout -->
            <div class="flex flex-row gap-4 flex-grow">
                
                <!-- Left Column -->
                <div class="w-[140px] flex flex-col gap-2">
                    <div class="profile-circle bg-white shadow-inner flex items-center justify-center">
                        <img id="profile-pic" src="" class="w-full h-full object-cover hidden">
                        <i id="placeholder-icon" data-lucide="user" class="w-12 h-12 text-green-200"></i>
                    </div>

                    <div class="flex flex-col gap-1">
                        <div>
                            <span class="label-pill">Name:</span>
                            <div id="out-name" class="output-text text-[11px] border-b border-dotted border-green-400 uppercase truncate mt-1">NI</div>
                        </div>
                        <div class="text-[9px] font-bold text-green-900 leading-tight">
                            <p>DOB: <span id="out-dob" class="output-text">NI</span></p>
                            <p>Origin: <span id="out-origin" class="output-text">NI</span></p>
                        </div>
                        <div class="flex items-center gap-1">
                            <i data-lucide="instagram" class="w-3 h-3 text-green-700"></i>
                            <span id="out-instagram" class="output-text text-[9px]">NI</span>
                        </div>
                        <div class="quote-box mt-1">
                            <div class="text-[6px] font-black text-green-700 uppercase mb-1">Quote:</div>
                            <div id="out-quote" class="italic">NI</div>
                        </div>
                    </div>
                </div>

                <!-- Right Column (Independent Profile Fields) -->
                <div class="flex-grow flex flex-col">
                    <h3 class="text-green-900 font-black text-[11px] border-b-2 border-green-800 inline-block uppercase mb-1">Profile Details</h3>
                    
                    <div class="flex flex-col justify-between flex-grow pb-1">
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Best Lecturer</span>
                            <span id="out-lecturer" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-green"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Best Level</span>
                            <span id="out-bestlevel" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-red"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Worst Level</span>
                            <span id="out-worstlevel" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-green"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Best Course</span>
                            <span id="out-bestcourse" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-red"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Worst Course</span>
                            <span id="out-worstcourse" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-green"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">If Not Biochem</span>
                            <span id="out-ifnot" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-red"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Crush in Class</span>
                            <span id="out-crush" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-green"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Relationship Status</span>
                            <span id="out-status" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-red"></div>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[7px] font-bold text-green-800 uppercase">Hobbies</span>
                            <span id="out-hobbies" class="output-text text-[9px]">NI</span>
                            <div class="gradient-bar bar-green"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Small DNA Watermark -->
            <div class="absolute bottom-2 right-4 opacity-10">
                <i data-lucide="dna" class="w-10 h-10 text-green-900"></i>
            </div>
        </div>
    </div>

    <script>
        async function exportAsImage(event) {
            const btn = event.currentTarget;
            const originalHTML = btn.innerHTML;
            
            try {
                btn.innerHTML = '<i data-lucide="loader" class="w-5 h-5 animate-spin"></i> GENERATING HIGH-RES...';
                if (window.lucide) window.lucide.createIcons();

                const element = document.getElementById('capture');
                await document.fonts.ready;
                await new Promise(resolve => setTimeout(resolve, 800));

                const canvas = await html2canvas(element, {
                    scale: 5,
                    useCORS: true,
                    logging: false,
                    backgroundColor: "#ffffff",
                    width: 400,
                    height: 500,
                    scrollX: 0,
                    scrollY: 0
                });

                const link = document.createElement('a');
                const nameValue = document.getElementById('in-name')?.value || 'FYB_Profile';
                link.download = `${nameValue.replace(/\s+/g, '_')}_FYB_Card.png`;
                link.href = canvas.toDataURL('image/png', 1.0);
                link.click();
                
            } catch (err) {
                console.error("Export Error:", err);
                alert("Export failed.");
            } finally {
                btn.innerHTML = originalHTML;
                if (window.lucide) window.lucide.createIcons();
            }
        }

        window.addEventListener('load', function() {
            if (window.lucide) window.lucide.createIcons();

            const inputs = [
                'name', 'dob', 'origin', 'quote', 'lecturer', 
                'bestlevel', 'worstlevel', 'bestcourse', 'worstcourse',
                'ifnot', 'crush', 'status', 'hobbies', 'instagram'
            ];

            inputs.forEach(id => {
                const inputEl = document.getElementById(`in-${id}`);
                const outputEl = document.getElementById(`out-${id}`);
                if (inputEl && outputEl) {
                    inputEl.addEventListener('input', () => {
                        outputEl.textContent = inputEl.value || "NI";
                    });
                }
            });

            const imageInput = document.getElementById('imageInput');
            const profilePic = document.getElementById('profile-pic');
            const placeholderIcon = document.getElementById('placeholder-icon');

            if (imageInput) {
                imageInput.addEventListener('change', function() {
                    const file = this.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            if (profilePic) {
                                profilePic.src = e.target.result;
                                profilePic.classList.remove('hidden');
                            }
                            if (placeholderIcon) {
                                placeholderIcon.classList.add('hidden');
                            }
                        }
                        reader.readAsDataURL(file);
                    }
                });
            }
        });
    </script>
</body>
</html>
